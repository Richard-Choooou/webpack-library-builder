!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PolyLine=e():t.PolyLine=e()}(self,(function(){return function(){"use strict";var t={d:function(e,n){for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(){}function o(t){return null==t?i:function(){return this.querySelector(t)}}function r(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function s(){return[]}function a(t){return null==t?s:function(){return this.querySelectorAll(t)}}function h(t){return function(){return this.matches(t)}}function l(t){return function(e){return e.matches(t)}}t.d(e,{default:function(){return Rn}});var u=Array.prototype.find;function c(){return this.firstElementChild}var d=Array.prototype.filter;function p(){return Array.from(this.children)}function f(t){return new Array(t.length)}function g(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function v(t){return function(){return t}}function b(t,e,n,i,o,r){for(var s,a=0,h=e.length,l=r.length;a<l;++a)(s=e[a])?(s.__data__=r[a],i[a]=s):n[a]=new g(t,r[a]);for(;a<h;++a)(s=e[a])&&(o[a]=s)}function m(t,e,n,i,o,r,s){var a,h,l,u=new Map,c=e.length,d=r.length,p=new Array(c);for(a=0;a<c;++a)(h=e[a])&&(p[a]=l=s.call(h,h.__data__,a,e)+"",u.has(l)?o[a]=h:u.set(l,h));for(a=0;a<d;++a)l=s.call(t,r[a],a,r)+"",(h=u.get(l))?(i[a]=h,h.__data__=r[a],u.delete(l)):n[a]=new g(t,r[a]);for(a=0;a<c;++a)(h=e[a])&&u.get(p[a])===h&&(o[a]=h)}function w(t){return t.__data__}function y(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function x(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}g.prototype={constructor:g,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var $="http://www.w3.org/1999/xhtml",_={svg:"http://www.w3.org/2000/svg",xhtml:$,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function k(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),_.hasOwnProperty(e)?{space:_[e],local:t}:t}function C(t){return function(){this.removeAttribute(t)}}function E(t){return function(){this.removeAttributeNS(t.space,t.local)}}function A(t,e){return function(){this.setAttribute(t,e)}}function M(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function S(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function L(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function R(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function P(t){return function(){this.style.removeProperty(t)}}function D(t,e,n){return function(){this.style.setProperty(t,e,n)}}function H(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function N(t,e){return t.style.getPropertyValue(e)||R(t).getComputedStyle(t,null).getPropertyValue(e)}function B(t){return function(){delete this[t]}}function q(t,e){return function(){this[t]=e}}function K(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function U(t){return t.trim().split(/^|\s+/)}function I(t){return t.classList||new X(t)}function X(t){this._node=t,this._names=U(t.getAttribute("class")||"")}function O(t,e){for(var n=I(t),i=-1,o=e.length;++i<o;)n.add(e[i])}function T(t,e){for(var n=I(t),i=-1,o=e.length;++i<o;)n.remove(e[i])}function j(t){return function(){O(this,t)}}function F(t){return function(){T(this,t)}}function z(t,e){return function(){(e.apply(this,arguments)?O:T)(this,t)}}function Y(){this.textContent=""}function V(t){return function(){this.textContent=t}}function W(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function G(){this.innerHTML=""}function Q(t){return function(){this.innerHTML=t}}function J(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Z(){this.nextSibling&&this.parentNode.appendChild(this)}function tt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function et(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===$&&e.documentElement.namespaceURI===$?e.createElement(t):e.createElementNS(n,t)}}function nt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function it(t){var e=k(t);return(e.local?nt:et)(e)}function ot(){return null}function rt(){var t=this.parentNode;t&&t.removeChild(this)}function st(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function at(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ht(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function lt(t){return function(){var e=this.__on;if(e){for(var n,i=0,o=-1,r=e.length;i<r;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?e.length=o:delete this.__on}}}function ut(t,e,n){return function(){var i,o=this.__on,r=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(o)for(var s=0,a=o.length;s<a;++s)if((i=o[s]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=r,i.options=n),void(i.value=e);this.addEventListener(t.type,r,n),i={type:t.type,name:t.name,value:e,listener:r,options:n},o?o.push(i):this.__on=[i]}}function ct(t,e,n){var i=R(t),o=i.CustomEvent;"function"==typeof o?o=new o(e,n):(o=i.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function dt(t,e){return function(){return ct(this,t,e)}}function pt(t,e){return function(){return ct(this,t,e.apply(this,arguments))}}X.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ft=[null];function gt(t,e){this._groups=t,this._parents=e}function vt(){return new gt([[document.documentElement]],ft)}gt.prototype=vt.prototype={constructor:gt,select:function(t){"function"!=typeof t&&(t=o(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,a,h=e[r],l=h.length,u=i[r]=new Array(l),c=0;c<l;++c)(s=h[c])&&(a=t.call(s,s.__data__,c,h))&&("__data__"in s&&(a.__data__=s.__data__),u[c]=a);return new gt(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return r(t.apply(this,arguments))}}(t):a(t);for(var e=this._groups,n=e.length,i=[],o=[],s=0;s<n;++s)for(var h,l=e[s],u=l.length,c=0;c<u;++c)(h=l[c])&&(i.push(t.call(h,h.__data__,c,l)),o.push(h));return new gt(i,o)},selectChild:function(t){return this.select(null==t?c:function(t){return function(){return u.call(this.children,t)}}("function"==typeof t?t:l(t)))},selectChildren:function(t){return this.selectAll(null==t?p:function(t){return function(){return d.call(this.children,t)}}("function"==typeof t?t:l(t)))},filter:function(t){"function"!=typeof t&&(t=h(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s=e[o],a=s.length,l=i[o]=[],u=0;u<a;++u)(r=s[u])&&t.call(r,r.__data__,u,s)&&l.push(r);return new gt(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,w);var n=e?m:b,i=this._parents,o=this._groups;"function"!=typeof t&&(t=v(t));for(var r=o.length,s=new Array(r),a=new Array(r),h=new Array(r),l=0;l<r;++l){var u=i[l],c=o[l],d=c.length,p=y(t.call(u,u&&u.__data__,l,i)),f=p.length,g=a[l]=new Array(f),x=s[l]=new Array(f),$=h[l]=new Array(d);n(u,c,g,x,$,p,e);for(var _,k,C=0,E=0;C<f;++C)if(_=g[C]){for(C>=E&&(E=C+1);!(k=x[E])&&++E<f;);_._next=k||null}}return(s=new gt(s,i))._enter=a,s._exit=h,s},enter:function(){return new gt(this._enter||this._groups.map(f),this._parents)},exit:function(){return new gt(this._exit||this._groups.map(f),this._parents)},join:function(t,e,n){var i=this.enter(),o=this,r=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(o=e(o))&&(o=o.selection()),null==n?r.remove():n(r),i&&o?i.merge(o).order():o},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,o=n.length,r=i.length,s=Math.min(o,r),a=new Array(o),h=0;h<s;++h)for(var l,u=n[h],c=i[h],d=u.length,p=a[h]=new Array(d),f=0;f<d;++f)(l=u[f]||c[f])&&(p[f]=l);for(;h<o;++h)a[h]=n[h];return new gt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,o=t[e],r=o.length-1,s=o[r];--r>=0;)(i=o[r])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=x);for(var n=this._groups,i=n.length,o=new Array(i),r=0;r<i;++r){for(var s,a=n[r],h=a.length,l=o[r]=new Array(h),u=0;u<h;++u)(s=a[u])&&(l[u]=s);l.sort(e)}return new gt(o,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],o=0,r=i.length;o<r;++o){var s=i[o];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var o,r=e[n],s=0,a=r.length;s<a;++s)(o=r[s])&&t.call(o,o.__data__,s,r);return this},attr:function(t,e){var n=k(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?E:C:"function"==typeof e?n.local?L:S:n.local?M:A)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?P:"function"==typeof e?H:D)(t,e,null==n?"":n)):N(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?B:"function"==typeof e?K:q)(t,e)):this.node()[t]},classed:function(t,e){var n=U(t+"");if(arguments.length<2){for(var i=I(this.node()),o=-1,r=n.length;++o<r;)if(!i.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?z:e?j:F)(n,e))},text:function(t){return arguments.length?this.each(null==t?Y:("function"==typeof t?W:V)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?G:("function"==typeof t?J:Q)(t)):this.node().innerHTML},raise:function(){return this.each(Z)},lower:function(){return this.each(tt)},append:function(t){var e="function"==typeof t?t:it(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:it(t),i=null==e?ot:"function"==typeof e?e:o(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(rt)},clone:function(t){return this.select(t?at:st)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,o,r=ht(t+""),s=r.length;if(!(arguments.length<2)){for(a=e?ut:lt,i=0;i<s;++i)this.each(a(r[i],e,n));return this}var a=this.node().__on;if(a)for(var h,l=0,u=a.length;l<u;++l)for(i=0,h=a[l];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value},dispatch:function(t,e){return this.each(("function"==typeof e?pt:dt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,o=t[e],r=0,s=o.length;r<s;++r)(i=o[r])&&(yield i)}};var bt=vt,mt={value:()=>{}};function wt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new yt(i)}function yt(t){this._=t}function xt(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function $t(t,e){for(var n,i=0,o=t.length;i<o;++i)if((n=t[i]).name===e)return n.value}function _t(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=mt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}yt.prototype=wt.prototype={constructor:yt,on:function(t,e){var n,i=this._,o=xt(t+"",i),r=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<s;)if(n=(t=o[r]).type)i[n]=_t(i[n],t.name,e);else if(null==e)for(n in i)i[n]=_t(i[n],t.name,null);return this}for(;++r<s;)if((n=(t=o[r]).type)&&(n=$t(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new yt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,o=new Array(n),r=0;r<n;++r)o[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],o=0,r=i.length;o<r;++o)i[o].value.apply(e,n)}};var kt,Ct,Et=wt,At=0,Mt=0,St=0,Lt=0,Rt=0,Pt=0,Dt="object"==typeof performance&&performance.now?performance:Date,Ht="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Nt(){return Rt||(Ht(Bt),Rt=Dt.now()+Pt)}function Bt(){Rt=0}function qt(){this._call=this._time=this._next=null}function Kt(t,e,n){var i=new qt;return i.restart(t,e,n),i}function Ut(){Rt=(Lt=Dt.now())+Pt,At=Mt=0;try{!function(){Nt(),++At;for(var t,e=kt;e;)(t=Rt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--At}()}finally{At=0,function(){for(var t,e,n=kt,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:kt=e);Ct=t,Xt(i)}(),Rt=0}}function It(){var t=Dt.now(),e=t-Lt;e>1e3&&(Pt-=e,Lt=t)}function Xt(t){At||(Mt&&(Mt=clearTimeout(Mt)),t-Rt>24?(t<1/0&&(Mt=setTimeout(Ut,t-Dt.now()-Pt)),St&&(St=clearInterval(St))):(St||(Lt=Dt.now(),St=setInterval(It,1e3)),At=1,Ht(Ut)))}function Ot(t,e,n){var i=new qt;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}qt.prototype=Kt.prototype={constructor:qt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Nt():+n)+(null==e?0:+e),this._next||Ct===this||(Ct?Ct._next=this:kt=this,Ct=this),this._call=t,this._time=n,Xt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Xt())}};var Tt=Et("start","end","cancel","interrupt"),jt=[];function Ft(t,e,n,i,o,r){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,o=t.__transition;function r(h){var l,u,c,d;if(1!==n.state)return a();for(l in o)if((d=o[l]).name===n.name){if(3===d.state)return Ot(r);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete o[l]):+l<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete o[l])}if(Ot((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(h))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(c=n.tween.length),l=0,u=-1;l<c;++l)(d=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function s(e){for(var o=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),r=-1,s=i.length;++r<s;)i[r].call(t,o);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=n,n.timer=Kt((function(t){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:o,on:Tt,tween:jt,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})}function zt(t,e){var n=Vt(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Yt(t,e){var n=Vt(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Vt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Wt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Gt,Qt=180/Math.PI,Jt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Zt(t,e,n,i,o,r){var s,a,h;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(h=t*n+e*i)&&(n-=t*h,i-=e*h),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,h/=a),t*i<e*n&&(t=-t,e=-e,h=-h,s=-s),{translateX:o,translateY:r,rotate:Math.atan2(e,t)*Qt,skewX:Math.atan(h)*Qt,scaleX:s,scaleY:a}}function te(t,e,n,i){function o(t){return t.length?t.pop()+" ":""}return function(r,s){var a=[],h=[];return r=t(r),s=t(s),function(t,i,o,r,s,a){if(t!==o||i!==r){var h=s.push("translate(",null,e,null,n);a.push({i:h-4,x:Wt(t,o)},{i:h-2,x:Wt(i,r)})}else(o||r)&&s.push("translate("+o+e+r+n)}(r.translateX,r.translateY,s.translateX,s.translateY,a,h),function(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(o(n)+"rotate(",null,i)-2,x:Wt(t,e)})):e&&n.push(o(n)+"rotate("+e+i)}(r.rotate,s.rotate,a,h),function(t,e,n,r){t!==e?r.push({i:n.push(o(n)+"skewX(",null,i)-2,x:Wt(t,e)}):e&&n.push(o(n)+"skewX("+e+i)}(r.skewX,s.skewX,a,h),function(t,e,n,i,r,s){if(t!==n||e!==i){var a=r.push(o(r)+"scale(",null,",",null,")");s.push({i:a-4,x:Wt(t,n)},{i:a-2,x:Wt(e,i)})}else 1===n&&1===i||r.push(o(r)+"scale("+n+","+i+")")}(r.scaleX,r.scaleY,s.scaleX,s.scaleY,a,h),r=s=null,function(t){for(var e,n=-1,i=h.length;++n<i;)a[(e=h[n]).i]=e.x(t);return a.join("")}}}var ee=te((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Jt:Zt(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ne=te((function(t){return null==t?Jt:(Gt||(Gt=document.createElementNS("http://www.w3.org/2000/svg","g")),Gt.setAttribute("transform",t),(t=Gt.transform.baseVal.consolidate())?Zt((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Jt)}),", ",")",")");function ie(t,e){var n,i;return function(){var o=Yt(this,t),r=o.tween;if(r!==n)for(var s=0,a=(i=n=r).length;s<a;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}o.tween=i}}function oe(t,e,n){var i,o;if("function"!=typeof n)throw new Error;return function(){var r=Yt(this,t),s=r.tween;if(s!==i){o=(i=s).slice();for(var a={name:e,value:n},h=0,l=o.length;h<l;++h)if(o[h].name===e){o[h]=a;break}h===l&&o.push(a)}r.tween=o}}function re(t,e,n){var i=t._id;return t.each((function(){var t=Yt(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Vt(t,i).value[e]}}function se(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ae(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function he(){}var le=.7,ue=1/le,ce="\\s*([+-]?\\d+)\\s*",de="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fe=/^#([0-9a-f]{3,8})$/,ge=new RegExp(`^rgb\\(${ce},${ce},${ce}\\)$`),ve=new RegExp(`^rgb\\(${pe},${pe},${pe}\\)$`),be=new RegExp(`^rgba\\(${ce},${ce},${ce},${de}\\)$`),me=new RegExp(`^rgba\\(${pe},${pe},${pe},${de}\\)$`),we=new RegExp(`^hsl\\(${de},${pe},${pe}\\)$`),ye=new RegExp(`^hsla\\(${de},${pe},${pe},${de}\\)$`),xe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function $e(){return this.rgb().formatHex()}function _e(){return this.rgb().formatRgb()}function ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=fe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ce(e):3===n?new Se(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ee(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ee(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ge.exec(t))?new Se(e[1],e[2],e[3],1):(e=ve.exec(t))?new Se(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=be.exec(t))?Ee(e[1],e[2],e[3],e[4]):(e=me.exec(t))?Ee(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=we.exec(t))?Ne(e[1],e[2]/100,e[3]/100,1):(e=ye.exec(t))?Ne(e[1],e[2]/100,e[3]/100,e[4]):xe.hasOwnProperty(t)?Ce(xe[t]):"transparent"===t?new Se(NaN,NaN,NaN,0):null}function Ce(t){return new Se(t>>16&255,t>>8&255,255&t,1)}function Ee(t,e,n,i){return i<=0&&(t=e=n=NaN),new Se(t,e,n,i)}function Ae(t){return t instanceof he||(t=ke(t)),t?new Se((t=t.rgb()).r,t.g,t.b,t.opacity):new Se}function Me(t,e,n,i){return 1===arguments.length?Ae(t):new Se(t,e,n,null==i?1:i)}function Se(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Le(){return`#${He(this.r)}${He(this.g)}${He(this.b)}`}function Re(){const t=Pe(this.opacity);return`${1===t?"rgb(":"rgba("}${De(this.r)}, ${De(this.g)}, ${De(this.b)}${1===t?")":`, ${t})`}`}function Pe(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function De(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function He(t){return((t=De(t))<16?"0":"")+t.toString(16)}function Ne(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new qe(t,e,n,i)}function Be(t){if(t instanceof qe)return new qe(t.h,t.s,t.l,t.opacity);if(t instanceof he||(t=ke(t)),!t)return new qe;if(t instanceof qe)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,o=Math.min(e,n,i),r=Math.max(e,n,i),s=NaN,a=r-o,h=(r+o)/2;return a?(s=e===r?(n-i)/a+6*(n<i):n===r?(i-e)/a+2:(e-n)/a+4,a/=h<.5?r+o:2-r-o,s*=60):a=h>0&&h<1?0:s,new qe(s,a,h,t.opacity)}function qe(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ke(t){return(t=(t||0)%360)<0?t+360:t}function Ue(t){return Math.max(0,Math.min(1,t||0))}function Ie(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Xe(t,e,n,i,o){var r=t*t,s=r*t;return((1-3*t+3*r-s)*e+(4-6*r+3*s)*n+(1+3*t+3*r-3*s)*i+s*o)/6}se(he,ke,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:$e,formatHex:$e,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Be(this).formatHsl()},formatRgb:_e,toString:_e}),se(Se,Me,ae(he,{brighter(t){return t=null==t?ue:Math.pow(ue,t),new Se(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?le:Math.pow(le,t),new Se(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Se(De(this.r),De(this.g),De(this.b),Pe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Le,formatHex:Le,formatHex8:function(){return`#${He(this.r)}${He(this.g)}${He(this.b)}${He(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Re,toString:Re})),se(qe,(function(t,e,n,i){return 1===arguments.length?Be(t):new qe(t,e,n,null==i?1:i)}),ae(he,{brighter(t){return t=null==t?ue:Math.pow(ue,t),new qe(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?le:Math.pow(le,t),new qe(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new Se(Ie(t>=240?t-240:t+120,o,i),Ie(t,o,i),Ie(t<120?t+240:t-120,o,i),this.opacity)},clamp(){return new qe(Ke(this.h),Ue(this.s),Ue(this.l),Pe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Pe(this.opacity);return`${1===t?"hsl(":"hsla("}${Ke(this.h)}, ${100*Ue(this.s)}%, ${100*Ue(this.l)}%${1===t?")":`, ${t})`}`}}));var Oe=t=>()=>t;function Te(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Oe(isNaN(t)?e:t)}var je=function t(e){var n=function(t){return 1==(t=+t)?Te:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):Oe(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=Me(t)).r,(e=Me(e)).r),o=n(t.g,e.g),r=n(t.b,e.b),s=Te(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=o(e),t.b=r(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function Fe(t){return function(e){var n,i,o=e.length,r=new Array(o),s=new Array(o),a=new Array(o);for(n=0;n<o;++n)i=Me(e[n]),r[n]=i.r||0,s[n]=i.g||0,a[n]=i.b||0;return r=t(r),s=t(s),a=t(a),i.opacity=1,function(t){return i.r=r(t),i.g=s(t),i.b=a(t),i+""}}}Fe((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[i],r=t[i+1],s=i>0?t[i-1]:2*o-r,a=i<e-1?t[i+2]:2*r-o;return Xe((n-i/e)*e,s,o,r,a)}})),Fe((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),o=t[(i+e-1)%e],r=t[i%e],s=t[(i+1)%e],a=t[(i+2)%e];return Xe((n-i/e)*e,o,r,s,a)}}));var ze=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ye=new RegExp(ze.source,"g");function Ve(t,e){var n,i,o,r=ze.lastIndex=Ye.lastIndex=0,s=-1,a=[],h=[];for(t+="",e+="";(n=ze.exec(t))&&(i=Ye.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,h.push({i:s,x:Wt(n,i)})),r=Ye.lastIndex;return r<e.length&&(o=e.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var n,i=0;i<e;++i)a[(n=h[i]).i]=n.x(t);return a.join("")})}function We(t,e){var n;return("number"==typeof e?Wt:e instanceof ke?je:(n=ke(e))?(e=n,je):Ve)(t,e)}function Ge(t){return function(){this.removeAttribute(t)}}function Qe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Je(t,e,n){var i,o,r=n+"";return function(){var s=this.getAttribute(t);return s===r?null:s===i?o:o=e(i=s,n)}}function Ze(t,e,n){var i,o,r=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?o:o=e(i=s,n)}}function tn(t,e,n){var i,o,r;return function(){var s,a,h=n(this);if(null!=h)return(s=this.getAttribute(t))===(a=h+"")?null:s===i&&a===o?r:(o=a,r=e(i=s,h));this.removeAttribute(t)}}function en(t,e,n){var i,o,r;return function(){var s,a,h=n(this);if(null!=h)return(s=this.getAttributeNS(t.space,t.local))===(a=h+"")?null:s===i&&a===o?r:(o=a,r=e(i=s,h));this.removeAttributeNS(t.space,t.local)}}function nn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function on(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function rn(t,e){var n,i;function o(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&on(t,o)),n}return o._value=e,o}function sn(t,e){var n,i;function o(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&nn(t,o)),n}return o._value=e,o}function an(t,e){return function(){zt(this,t).delay=+e.apply(this,arguments)}}function hn(t,e){return e=+e,function(){zt(this,t).delay=e}}function ln(t,e){return function(){Yt(this,t).duration=+e.apply(this,arguments)}}function un(t,e){return e=+e,function(){Yt(this,t).duration=e}}function cn(t,e){if("function"!=typeof e)throw new Error;return function(){Yt(this,t).ease=e}}function dn(t,e,n){var i,o,r=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?zt:Yt;return function(){var s=r(this,t),a=s.on;a!==i&&(o=(i=a).copy()).on(e,n),s.on=o}}var pn=bt.prototype.constructor;function fn(t){return function(){this.style.removeProperty(t)}}function gn(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function vn(t,e,n){var i,o;function r(){var r=e.apply(this,arguments);return r!==o&&(i=(o=r)&&gn(t,r,n)),i}return r._value=e,r}function bn(t){return function(e){this.textContent=t.call(this,e)}}function mn(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&bn(i)),e}return i._value=t,i}var wn=0;function yn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function xn(){return++wn}var $n=bt.prototype;yn.prototype=function(t){return bt().transition(t)}.prototype={constructor:yn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=o(t));for(var i=this._groups,r=i.length,s=new Array(r),a=0;a<r;++a)for(var h,l,u=i[a],c=u.length,d=s[a]=new Array(c),p=0;p<c;++p)(h=u[p])&&(l=t.call(h,h.__data__,p,u))&&("__data__"in h&&(l.__data__=h.__data__),d[p]=l,Ft(d[p],e,n,p,d,Vt(h,n)));return new yn(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=a(t));for(var i=this._groups,o=i.length,r=[],s=[],h=0;h<o;++h)for(var l,u=i[h],c=u.length,d=0;d<c;++d)if(l=u[d]){for(var p,f=t.call(l,l.__data__,d,u),g=Vt(l,n),v=0,b=f.length;v<b;++v)(p=f[v])&&Ft(p,e,n,v,f,g);r.push(f),s.push(l)}return new yn(r,s,e,n)},selectChild:$n.selectChild,selectChildren:$n.selectChildren,filter:function(t){"function"!=typeof t&&(t=h(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s=e[o],a=s.length,l=i[o]=[],u=0;u<a;++u)(r=s[u])&&t.call(r,r.__data__,u,s)&&l.push(r);return new yn(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,o=n.length,r=Math.min(i,o),s=new Array(i),a=0;a<r;++a)for(var h,l=e[a],u=n[a],c=l.length,d=s[a]=new Array(c),p=0;p<c;++p)(h=l[p]||u[p])&&(d[p]=h);for(;a<i;++a)s[a]=e[a];return new yn(s,this._parents,this._name,this._id)},selection:function(){return new pn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=xn(),i=this._groups,o=i.length,r=0;r<o;++r)for(var s,a=i[r],h=a.length,l=0;l<h;++l)if(s=a[l]){var u=Vt(s,e);Ft(s,t,n,l,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new yn(i,this._parents,t,n)},call:$n.call,nodes:$n.nodes,node:$n.node,size:$n.size,empty:$n.empty,each:$n.each,on:function(t,e){var n=this._id;return arguments.length<2?Vt(this.node(),n).on.on(t):this.each(dn(n,t,e))},attr:function(t,e){var n=k(t),i="transform"===n?ne:We;return this.attrTween(t,"function"==typeof e?(n.local?en:tn)(n,i,re(this,"attr."+t,e)):null==e?(n.local?Qe:Ge)(n):(n.local?Ze:Je)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=k(t);return this.tween(n,(i.local?rn:sn)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?ee:We;return null==e?this.styleTween(t,function(t,e){var n,i,o;return function(){var r=N(this,t),s=(this.style.removeProperty(t),N(this,t));return r===s?null:r===n&&s===i?o:o=e(n=r,i=s)}}(t,i)).on("end.style."+t,fn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,o,r;return function(){var s=N(this,t),a=n(this),h=a+"";return null==a&&(this.style.removeProperty(t),h=a=N(this,t)),s===h?null:s===i&&h===o?r:(o=h,r=e(i=s,a))}}(t,i,re(this,"style."+t,e))).each(function(t,e){var n,i,o,r,s="style."+e,a="end."+s;return function(){var h=Yt(this,t),l=h.on,u=null==h.value[s]?r||(r=fn(e)):void 0;l===n&&o===u||(i=(n=l).copy()).on(a,o=u),h.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,o,r=n+"";return function(){var s=N(this,t);return s===r?null:s===i?o:o=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,vn(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(re(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,mn(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,o=Vt(this.node(),n).tween,r=0,s=o.length;r<s;++r)if((i=o[r]).name===t)return i.value;return null}return this.each((null==e?ie:oe)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?an:hn)(e,t)):Vt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ln:un)(e,t)):Vt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(cn(e,t)):Vt(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Yt(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,o=n.size();return new Promise((function(r,s){var a={value:s},h={value:function(){0==--o&&r()}};n.each((function(){var n=Yt(this,i),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(h)),n.on=e})),0===o&&r()}))},[Symbol.iterator]:$n[Symbol.iterator]};var _n={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function kn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}bt.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,o,r=t.__transition,s=!0;if(r){for(o in e=null==e?null:e+"",r)(n=r[o]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[o]):s=!1;s&&delete t.__transition}}(this,t)}))},bt.prototype.transition=function(t){var e,n;t instanceof yn?(e=t._id,t=t._name):(e=xn(),(n=_n).time=Nt(),t=null==t?null:t+"");for(var i=this._groups,o=i.length,r=0;r<o;++r)for(var s,a=i[r],h=a.length,l=0;l<h;++l)(s=a[l])&&Ft(s,t,e,l,a,n||kn(s,e));return new yn(i,this._parents,t,e)};const{abs:Cn,max:En,min:An}=Math;function Mn(t){return{type:t}}function Sn(t,e,n){this.k=t,this.x=e,this.y=n}["w","e"].map(Mn),["n","s"].map(Mn),["n","w","e","s","nw","ne","sw","se"].map(Mn),Sn.prototype={constructor:Sn,scale:function(t){return 1===t?this:new Sn(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Sn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Sn(1,0,0),Sn.prototype,(()=>{var t=Object.defineProperty,e=(e,n,i)=>(((e,n,i)=>{n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i})(e,"symbol"!=typeof n?n+"":n,i),i),n="tc-hsv-changed",i="tc-hue-changed",o="tc-alpha-changed",r="tc-button-clicked",s=(t,e)=>{!t||document.dispatchEvent(new CustomEvent(o,{detail:{a:e,cid:t}}))},a=(t,e,i,o)=>{!t||document.dispatchEvent(new CustomEvent(n,{detail:{h:e,s:i,v:o,cid:t}}))};function h(t,e){(function(t){return"string"==typeof t&&-1!==t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!==t.indexOf("%")}(t);return t=360===e?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:t=360===e?(t<0?t%e+e:t%e)/parseFloat(String(e)):t%e/parseFloat(String(e))}function l(t){return Math.min(1,Math.max(0,t))}function u(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function c(t){return t<=1?"".concat(100*Number(t),"%"):t}function d(t){return 1===t.length?"0"+t:String(t)}function p(t,e,n){t=h(t,255),e=h(e,255),n=h(n,255);var i=Math.max(t,e,n),o=Math.min(t,e,n),r=0,s=0,a=(i+o)/2;if(i===o)s=0,r=0;else{var l=i-o;switch(s=a>.5?l/(2-i-o):l/(i+o),i){case t:r=(e-n)/l+(e<n?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:s,l:a}}function f(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*n*(e-t):n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function g(t,e,n){t=h(t,255),e=h(e,255),n=h(n,255);var i=Math.max(t,e,n),o=Math.min(t,e,n),r=0,s=i,a=i-o,l=0===i?0:a/i;if(i===o)r=0;else{switch(i){case t:r=(e-n)/a+(e<n?6:0);break;case e:r=(n-t)/a+2;break;case n:r=(t-e)/a+4}r/=6}return{h:r,s:l,v:s}}function v(t,e,n,i){var o=[d(Math.round(t).toString(16)),d(Math.round(e).toString(16)),d(Math.round(n).toString(16))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function b(t){return Math.round(255*parseFloat(t)).toString(16)}function m(t){return w(t)/255}function w(t){return parseInt(t,16)}var y={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var x="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),$="[\\s|\\(]+(".concat(x,")[,|\\s]+(").concat(x,")[,|\\s]+(").concat(x,")\\s*\\)?"),_="[\\s|\\(]+(".concat(x,")[,|\\s]+(").concat(x,")[,|\\s]+(").concat(x,")[,|\\s]+(").concat(x,")\\s*\\)?"),k={CSS_UNIT:new RegExp(x),rgb:new RegExp("rgb"+$),rgba:new RegExp("rgba"+_),hsl:new RegExp("hsl"+$),hsla:new RegExp("hsla"+_),hsv:new RegExp("hsv"+$),hsva:new RegExp("hsva"+_),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function C(t){return Boolean(k.CSS_UNIT.exec(String(t)))}var E=function(){function t(e,n){var i;if(void 0===e&&(e=""),void 0===n&&(n={}),e instanceof t)return e;"number"==typeof e&&(e=function(t){return{r:t>>16,g:(65280&t)>>8,b:255&t}}(e)),this.originalInput=e;var o=function(t){var e={r:0,g:0,b:0},n=1,i=null,o=null,r=null,s=!1,a=!1;return"string"==typeof t&&(t=function(t){if(0===(t=t.trim().toLowerCase()).length)return!1;var e=!1;if(y[t])t=y[t],e=!0;else if("transparent"===t)return{r:0,g:0,b:0,a:0,format:"name"};var n=k.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=k.rgba.exec(t))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=k.hsl.exec(t))?{h:n[1],s:n[2],l:n[3]}:(n=k.hsla.exec(t))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=k.hsv.exec(t))?{h:n[1],s:n[2],v:n[3]}:(n=k.hsva.exec(t))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=k.hex8.exec(t))?{r:w(n[1]),g:w(n[2]),b:w(n[3]),a:m(n[4]),format:e?"name":"hex8"}:(n=k.hex6.exec(t))?{r:w(n[1]),g:w(n[2]),b:w(n[3]),format:e?"name":"hex"}:(n=k.hex4.exec(t))?{r:w(n[1]+n[1]),g:w(n[2]+n[2]),b:w(n[3]+n[3]),a:m(n[4]+n[4]),format:e?"name":"hex8"}:!!(n=k.hex3.exec(t))&&{r:w(n[1]+n[1]),g:w(n[2]+n[2]),b:w(n[3]+n[3]),format:e?"name":"hex"}}(t)),"object"==typeof t&&(C(t.r)&&C(t.g)&&C(t.b)?(e=function(t,e,n){return{r:255*h(t,255),g:255*h(e,255),b:255*h(n,255)}}(t.r,t.g,t.b),s=!0,a="%"===String(t.r).substr(-1)?"prgb":"rgb"):C(t.h)&&C(t.s)&&C(t.v)?(i=c(t.s),o=c(t.v),e=function(t,e,n){t=6*h(t,360),e=h(e,100),n=h(n,100);var i=Math.floor(t),o=t-i,r=n*(1-e),s=n*(1-o*e),a=n*(1-(1-o)*e),l=i%6;return{r:255*[n,s,r,r,a,n][l],g:255*[a,n,n,s,r,r][l],b:255*[r,r,a,n,n,s][l]}}(t.h,i,o),s=!0,a="hsv"):C(t.h)&&C(t.s)&&C(t.l)&&(i=c(t.s),r=c(t.l),e=function(t,e,n){var i,o,r;if(t=h(t,360),e=h(e,100),n=h(n,100),0===e)o=n,r=n,i=n;else{var s=n<.5?n*(1+e):n+e-n*e,a=2*n-s;i=f(a,s,t+1/3),o=f(a,s,t),r=f(a,s,t-1/3)}return{r:255*i,g:255*o,b:255*r}}(t.h,i,r),s=!0,a="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=u(n),{ok:s,format:t.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}(e);this.originalInput=e,this.r=o.r,this.g=o.g,this.b=o.b,this.a=o.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(i=n.format)&&void 0!==i?i:o.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=o.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),e=t.r/255,n=t.g/255,i=t.b/255;return.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=u(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.toHsv=function(){var t=g(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=g(this.r,this.g,this.b),e=Math.round(360*t.h),n=Math.round(100*t.s),i=Math.round(100*t.v);return 1===this.a?"hsv(".concat(e,", ").concat(n,"%, ").concat(i,"%)"):"hsva(".concat(e,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var t=p(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=p(this.r,this.g,this.b),e=Math.round(360*t.h),n=Math.round(100*t.s),i=Math.round(100*t.l);return 1===this.a?"hsl(".concat(e,", ").concat(n,"%, ").concat(i,"%)"):"hsla(".concat(e,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(t){return void 0===t&&(t=!1),v(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),"#"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,e,n,i,o){var r=[d(Math.round(t).toString(16)),d(Math.round(e).toString(16)),d(Math.round(n).toString(16)),d(b(i))];return o&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))&&r[3].startsWith(r[3].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),"#"+this.toHex8(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),e=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(t,", ").concat(e,", ").concat(n,")"):"rgba(".concat(t,", ").concat(e,", ").concat(n,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var t=function(t){return"".concat(Math.round(100*h(t,255)),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*h(t,255))};return 1===this.a?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var t="#"+v(this.r,this.g,this.b,!1),e=0,n=Object.entries(y);e<n.length;e++){var i=n[e],o=i[0];if(t===i[1])return o}return!1},t.prototype.toString=function(t){var e=Boolean(t);t=null!=t?t:this.format;var n=!1,i=this.a<1&&this.a>=0;return e||!i||!t.startsWith("hex")&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=l(n.l),new t(n)},t.prototype.brighten=function(e){void 0===e&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-e/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-e/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-e/100*255))),new t(n)},t.prototype.darken=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=l(n.l),new t(n)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix("white",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix("black",t)},t.prototype.desaturate=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=l(n.s),new t(n)},t.prototype.saturate=function(e){void 0===e&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=l(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,new t(n)},t.prototype.mix=function(e,n){void 0===n&&(n=50);var i=this.toRgb(),o=new t(e).toRgb(),r=n/100;return new t({r:(o.r-i.r)*r+i.r,g:(o.g-i.g)*r+i.g,b:(o.b-i.b)*r+i.b,a:(o.a-i.a)*r+i.a})},t.prototype.analogous=function(e,n){void 0===e&&(e=6),void 0===n&&(n=30);var i=this.toHsl(),o=360/n,r=[this];for(i.h=(i.h-(o*e>>1)+720)%360;--e;)i.h=(i.h+o)%360,r.push(new t(i));return r},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){void 0===e&&(e=6);for(var n=this.toHsv(),i=n.h,o=n.s,r=n.v,s=[],a=1/e;e--;)s.push(new t({h:i,s:o,v:r})),r=(r+a)%1;return s},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),i=new t(e).toRgb();return new t({r:i.r+(n.r-i.r)*n.a,g:i.g+(n.g-i.g)*n.a,b:i.b+(n.b-i.b)*n.a})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),i=n.h,o=[this],r=360/e,s=1;s<e;s++)o.push(new t({h:(i+s*r)%360,s:n.s,l:n.l}));return o},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}(),A=()=>Math.random().toString(16).slice(2),M=t=>Math.round(100*(t+Number.EPSILON))/100,S=.01,L=t=>(t<0&&(t=0),t>360&&(t=360),`hsl(${Math.round(t)}, 100%, 50%)`),R=t=>{let e=t.toRgb();return`linear-gradient(to right, rgba(${e.r},${e.g},${e.b}, 0) 0%, rgba(${e.r},${e.g},${e.b}, 1) 100%)`},P=t=>{let e=t.toRgb();return`rgba(${e.r}, ${e.g}, ${e.b}, ${M(e.a)})`},D=t=>(t<0&&(t=0),t>1&&(t=1),`${(-100*t+100).toFixed(2)}%`),H=t=>(t<0&&(t=0),t>1&&(t=1),`${(100*t).toFixed(2)}%`),N=t=>{t<0&&(t=0),t>360&&(t=360);let e=100*t/360,n=Math.round(100*e)/100;return n<0&&(n=0),n>100&&(n=100),n},B=t=>360*t/100,q=t=>{let e=Number(t)||0;return e=Math.round(e),e=Math.max(0,e),e=Math.min(255,e),e},K=t=>{let e=new E(t||"#000");return e.setAlpha(e.getAlpha()),e},U=class extends HTMLElement{constructor(){super(),e(this,"cid"),e(this,"$saturation"),e(this,"$color"),e(this,"$pointer"),e(this,"hue",0),e(this,"saturation",0),e(this,"value",0),this.attachShadow({mode:"open"}),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onChange=this.onChange.bind(this),this.onPointerKeyDown=this.onPointerKeyDown.bind(this),this.hsvChanged=this.hsvChanged.bind(this),this.hueChanged=this.hueChanged.bind(this)}static get observedAttributes(){return["color"]}render(t=!0){this.$pointer&&(this.$pointer.style.left=H(this.saturation),this.$pointer.style.top=D(this.value)),this.$color&&this.$color.setAttribute("style",`background: ${L(this.hue)}`),t&&a(this.cid,this.hue,this.saturation,this.value)}onChange(t){if(!this.$saturation)return;let{width:e,height:n,left:i,top:o}=this.$saturation.getBoundingClientRect();if(0===e||0===n)return;let r="number"==typeof t.clientX?t.clientX:t.touches[0].clientX,s="number"==typeof t.clientY?t.clientY:t.touches[0].clientY,a=Math.min(Math.max(0,r-i),e),h=Math.min(Math.max(0,s-o),n);this.saturation=a/e,this.value=1-h/n,this.render()}onPointerKeyDown(t){switch(t.key){case"ArrowLeft":this.saturation=Math.max(0,this.saturation-S),this.render();break;case"ArrowRight":this.saturation=Math.min(1,this.saturation+S),this.render();break;case"ArrowUp":this.value=Math.min(1,this.value+S),this.render();break;case"ArrowDown":t.preventDefault(),this.value=Math.max(0,this.value-S),this.render()}}onMouseDown(t){t.preventDefault&&t.preventDefault(),this.onChange(t),window.addEventListener("mousemove",this.onChange),window.addEventListener("mouseup",this.onMouseUp),window.setTimeout((()=>{var t;null==(t=this.$pointer)||t.focus()}),0)}onMouseUp(){window.removeEventListener("mousemove",this.onChange),window.removeEventListener("mouseup",this.onChange)}hsvChanged(t){if(!t||!t.detail||!t.detail.cid||t.detail.cid!==this.cid)return;let e=!1;this.hue!==t.detail.h&&(this.hue=t.detail.h,e=!0),this.saturation!==t.detail.s&&(this.saturation=t.detail.s,e=!0),this.value!==t.detail.v&&(this.value=t.detail.v,e=!0),e&&this.render(!1)}hueChanged(t){!t||!t.detail||!t.detail.cid||t.detail.cid===this.cid&&(this.hue=t.detail.h,this.render())}connectedCallback(){var t,e,o,r,s;if(!this.shadowRoot)return;this.cid=this.getAttribute("cid")||"";let a=K(this.getAttribute("color")).toHsv();this.hue=a.h,this.saturation=a.s,this.value=a.v;let h=D(this.value),l=H(this.saturation);this.shadowRoot.innerHTML=`\n           <style>.saturation{touch-action:none;overflow:hidden;width:100%;height:9rem;position:relative}.box{width:100%;height:100%;position:absolute}.white{background:linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.black{background:linear-gradient(0,#000,transparent)}.pointer{top:34.902%;left:18.6747%;cursor:pointer;position:absolute;outline:0}.handler{box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgb(0,0,0,0.3),0 0 1px 2px rgb(0,0,0,0.4);-webkit-transform:translate(-2px,-2px);transform:translate(-2px,-2px);border-radius:100%;width:.25rem;height:.25rem;outline:0}</style>\n           <div class="saturation">\n                <div class="box" style="background: ${L(this.hue)}">\n                    <div class="white box">\n                        <div class="black box"></div>\n                        \n                        <div class="pointer" tabindex="0" style="top: ${h}; left: ${l};">\n                            <div class="handler"></div>\n                        </div>\n                    </div>\n                </div>\n           </div>\n        `,this.$saturation=this.shadowRoot.querySelector(".saturation"),this.$color=this.shadowRoot.querySelector(".box"),this.$pointer=this.shadowRoot.querySelector(".pointer"),null==(t=this.$pointer)||t.addEventListener("keydown",this.onPointerKeyDown),null==(e=this.$saturation)||e.addEventListener("mousedown",this.onMouseDown),null==(o=this.$saturation)||o.addEventListener("mouseup",this.onMouseUp),null==(r=this.$saturation)||r.addEventListener("touchmove",this.onChange),null==(s=this.$saturation)||s.addEventListener("touchstart",this.onChange),document.addEventListener(n,this.hsvChanged),document.addEventListener(i,this.hueChanged)}disconnectedCallback(){var t,e,o,r,s;null==(t=this.$saturation)||t.removeEventListener("mousedown",this.onMouseDown),null==(e=this.$saturation)||e.removeEventListener("mouseup",this.onMouseUp),null==(o=this.$saturation)||o.removeEventListener("touchmove",this.onChange),null==(r=this.$saturation)||r.removeEventListener("touchstart",this.onChange),null==(s=this.$pointer)||s.removeEventListener("keydown",this.onPointerKeyDown),document.removeEventListener(n,this.hsvChanged),document.removeEventListener(i,this.hueChanged)}attributeChangedCallback(t,e,n){let i=K(n).toHsv();this.hue=i.h,this.saturation=i.s,this.value=i.v,this.render(!1)}},I=class extends HTMLElement{constructor(){super(),e(this,"cid"),e(this,"$hue"),e(this,"$pointer"),e(this,"hue",0),this.attachShadow({mode:"open"}),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onChange=this.onChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.hsvChanged=this.hsvChanged.bind(this)}static get observedAttributes(){return["color"]}render(){var t,e;this.$pointer&&(this.$pointer.style.left=`${N(this.hue)}%`),t=this.cid,e=this.hue,!t||document.dispatchEvent(new CustomEvent(i,{detail:{h:e,cid:t}}))}hsvChanged(t){!t||!t.detail||!t.detail.cid||t.detail.cid===this.cid&&this.hue!==t.detail.h&&(this.hue=t.detail.h,this.render())}onChange(t){if(!this.$hue)return;t.preventDefault&&t.preventDefault();let{width:e,left:n}=this.$hue.getBoundingClientRect();if(0===e)return;let i="number"==typeof t.clientX?t.clientX:t.touches[0].clientX,o=Math.min(Math.max(0,i-n),e),r=Math.min(Math.max(0,Math.round(100*o/e)),100);this.hue=B(r),this.render()}onKeyDown(t){var e;switch(null==(e=this.$pointer)||e.focus(),t.key){case"ArrowLeft":{let t=N(this.hue);t=Math.max(0,t-1),this.hue=B(t),this.render();break}case"ArrowRight":{let t=N(this.hue);t=Math.min(100,t+1),this.hue=B(t),this.render();break}}}onMouseDown(t){t.preventDefault&&t.preventDefault(),this.onChange(t),window.addEventListener("mousemove",this.onChange),window.addEventListener("mouseup",this.onMouseUp),window.setTimeout((()=>{var t;null==(t=this.$pointer)||t.focus()}),0)}onMouseUp(){window.removeEventListener("mousemove",this.onChange),window.removeEventListener("mouseup",this.onChange)}connectedCallback(){var t,e,i,o,r;if(!this.shadowRoot)return;this.cid=this.getAttribute("cid")||"";let s=K(this.getAttribute("color"));this.hue=s.toHsv().h,this.shadowRoot.innerHTML=`\n           <style>.hue{overflow:hidden;height:.625rem;margin-bottom:.25rem;margin-top:.25rem;position:relative}.box{width:100%;height:100%;position:absolute}.hue-v{background:linear-gradient(0,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.hue-h{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red);width:100%;height:100%;position:relative}.pointer-box{left:87%;position:absolute;outline:0}.handler{background:#fff;box-shadow:0 0 2px rgb(0 0 0 / 60%);box-sizing:border-box;border:1px solid hsla(0,0%,88%,.5);height:8px;margin-top:1px;-webkit-transform:translateX(-4px);transform:translateX(-4px);width:8px;cursor:pointer;outline:0}.pointer-box:focus .handler{border:2px solid hsla(0,0%,88%,1)}</style>\n           <div class="hue">\n                <div class="box">\n                    <div class="hue-v box">\n                        <div class="hue-h"></div>\n                    </div>\n                    \n                    <div class="pointer box">\n                        <div class="pointer-box" tabindex="0" style="left: ${N(this.hue)}%">\n                            <div class="handler"></div>\n                        </div>\n                    </div>\n                </div>\n           </div>\n        `,this.$hue=this.shadowRoot.querySelector(".hue"),this.$pointer=this.shadowRoot.querySelector(".pointer-box"),null==(t=this.$hue)||t.addEventListener("mousedown",this.onMouseDown),null==(e=this.$hue)||e.addEventListener("mouseup",this.onMouseUp),null==(i=this.$hue)||i.addEventListener("touchmove",this.onChange),null==(o=this.$hue)||o.addEventListener("touchstart",this.onChange),null==(r=this.$pointer)||r.addEventListener("keydown",this.onKeyDown),document.addEventListener(n,this.hsvChanged)}disconnectedCallback(){var t,e,i,o,r;null==(t=this.$hue)||t.removeEventListener("mousedown",this.onMouseDown),null==(e=this.$hue)||e.removeEventListener("mouseup",this.onMouseUp),null==(i=this.$hue)||i.removeEventListener("touchmove",this.onChange),null==(o=this.$hue)||o.removeEventListener("touchstart",this.onChange),null==(r=this.$pointer)||r.removeEventListener("keydown",this.onKeyDown),document.removeEventListener(n,this.hsvChanged)}attributeChangedCallback(t,e,n){let i=K(n).toHsv();this.hue=i.h,this.render()}},X=class extends HTMLElement{constructor(){super(),e(this,"cid"),e(this,"$alpha"),e(this,"$color"),e(this,"$pointer"),e(this,"alpha",1),e(this,"hue",0),e(this,"saturation",0),e(this,"value",0),this.attachShadow({mode:"open"}),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onChange=this.onChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.hsvChanged=this.hsvChanged.bind(this),this.hueChanged=this.hueChanged.bind(this),this.alphaChanged=this.alphaChanged.bind(this)}static get observedAttributes(){return["color"]}render(t=!0){if(this.$pointer&&(this.$pointer.style.left=100*this.alpha+"%"),this.$color){let t=new E({h:this.hue,s:this.saturation,v:this.value,a:this.alpha});this.$color.style.background=R(t)}t&&s(this.cid,this.alpha)}onChange(t){if(!this.$alpha)return;t.preventDefault&&t.preventDefault();let{width:e,left:n}=this.$alpha.getBoundingClientRect();if(0===e)return;let i="number"==typeof t.clientX?t.clientX:t.touches[0].clientX,o=Math.min(Math.max(0,i-n),e),r=Math.min(Math.max(0,100*o/e),100);this.alpha=r/100,this.render()}onKeyDown(t){var e;switch(null==(e=this.$pointer)||e.focus(),t.key){case"ArrowLeft":{let t=100*this.alpha;t=Math.max(0,t-1),this.alpha=t/100,this.render();break}case"ArrowRight":{let t=100*this.alpha;t=Math.min(100,t+1),this.alpha=t/100,this.render();break}}}hsvChanged(t){!t||!t.detail||!t.detail.cid||t.detail.cid===this.cid&&(this.saturation=t.detail.h,this.hue=t.detail.s,this.value=t.detail.v,this.render(!1))}hueChanged(t){!t||!t.detail||!t.detail.cid||t.detail.cid===this.cid&&(this.hue=t.detail.h,this.render(!1))}alphaChanged(t){!t||!t.detail||!t.detail.cid||t.detail.cid===this.cid&&this.alpha!==t.detail.a&&(this.alpha=t.detail.a,this.render())}onMouseDown(t){t.preventDefault&&t.preventDefault(),this.onChange(t),window.addEventListener("mousemove",this.onChange),window.addEventListener("mouseup",this.onMouseUp),window.setTimeout((()=>{var t;null==(t=this.$pointer)||t.focus()}),0)}onMouseUp(){window.removeEventListener("mousemove",this.onChange),window.removeEventListener("mouseup",this.onChange)}connectedCallback(){var t,e,r,s,a;if(!this.shadowRoot)return;this.cid=this.getAttribute("cid")||"";let h=K(this.getAttribute("color")),l=h.toHsv();this.alpha=l.a,this.hue=l.h,this.saturation=l.s,this.value=l.v,this.shadowRoot.innerHTML=`\n           <style>.alpha{overflow:hidden;height:.625rem;position:relative;background:#fff}.box{width:100%;height:100%;position:absolute}.transparent-bg{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAADFJREFUOE9jZGBgEGHAD97gk2YcNYBhmIQBgWSAP52AwoAQwJvQRg1gACckQoC2gQgAIF8IscwEtKYAAAAASUVORK5CYII=);overflow:hidden}.pointer-box{left:100%;position:absolute;outline:0}.handler{background:#fff;box-shadow:0 0 2px rgb(0 0 0 / 60%);box-sizing:border-box;border:1px solid hsla(0,0%,88%,.5);height:8px;margin-top:1px;-webkit-transform:translateX(-4px);transform:translateX(-4px);width:8px;cursor:pointer;outline:0}.alpha-pointer-box:focus .alpha-pointer-handler{border:2px solid hsla(0,0%,88%,1)}</style>\n           <div class="alpha">\n                <div class="box">\n                    <div class="transparent-bg box"></div>\n                    <div class="color-bg box" style="background: ${R(h)}"></div>\n                    \n                    <div class="pointer box">\n                        <div class="pointer-box" tabindex="0" style="left: ${100*this.alpha}%;" >\n                            <div class="handler"></div>\n                        </div>\n                    </div>\n                </div>\n           </div>\n        `,this.$alpha=this.shadowRoot.querySelector(".alpha"),this.$color=this.shadowRoot.querySelector(".color-bg"),this.$pointer=this.shadowRoot.querySelector(".pointer-box"),null==(t=this.$alpha)||t.addEventListener("mousedown",this.onMouseDown),null==(e=this.$alpha)||e.addEventListener("mouseup",this.onMouseUp),null==(r=this.$alpha)||r.addEventListener("touchmove",this.onChange),null==(s=this.$alpha)||s.addEventListener("touchstart",this.onChange),null==(a=this.$pointer)||a.addEventListener("keydown",this.onKeyDown),document.addEventListener(n,this.hsvChanged),document.addEventListener(i,this.hueChanged),document.addEventListener(o,this.alphaChanged)}disconnectedCallback(){var t,e,r,s,a;null==(t=this.$alpha)||t.removeEventListener("mousedown",this.onMouseDown),null==(e=this.$alpha)||e.removeEventListener("mouseup",this.onMouseUp),null==(r=this.$alpha)||r.removeEventListener("touchmove",this.onChange),null==(s=this.$alpha)||s.removeEventListener("touchstart",this.onChange),null==(a=this.$pointer)||a.removeEventListener("keydown",this.onKeyDown),document.removeEventListener(n,this.hsvChanged),document.removeEventListener(i,this.hueChanged),document.removeEventListener(o,this.alphaChanged)}attributeChangedCallback(t,e,n){let i=K(n).toHsv();this.alpha=i.a,this.hue=i.h,this.saturation=i.s,this.value=i.v,this.render()}},O=class extends HTMLElement{constructor(){super(),e(this,"cid"),e(this,"color",new E("#000")),e(this,"$hex"),e(this,"$r"),e(this,"$g"),e(this,"$b"),e(this,"$a"),e(this,"hex",""),e(this,"r",0),e(this,"g",0),e(this,"b",0),e(this,"a",1),this.attachShadow({mode:"open"}),this.hsvChanged=this.hsvChanged.bind(this),this.hueChanged=this.hueChanged.bind(this),this.alphaChanged=this.alphaChanged.bind(this),this.onHexChange=this.onHexChange.bind(this),this.render=this.render.bind(this),this.onRedChange=this.onRedChange.bind(this),this.onGreenChange=this.onGreenChange.bind(this),this.onBlueChange=this.onBlueChange.bind(this),this.onAlphaChange=this.onAlphaChange.bind(this),this.onRedKeyDown=this.onRedKeyDown.bind(this),this.onBlueKeyDown=this.onBlueKeyDown.bind(this),this.onGreenKeyDown=this.onGreenKeyDown.bind(this),this.onAlphaKeyDown=this.onAlphaKeyDown.bind(this)}static get observedAttributes(){return["color"]}hueChanged(t){if(!t||!t.detail||!t.detail.cid||t.detail.cid!==this.cid)return;let e=this.color.toHsv();this.color=new E({h:Number(t.detail.h),s:e.s,v:e.v,a:e.a}),this.render()}alphaChanged(t){if(!t||!t.detail||!t.detail.cid||t.detail.cid!==this.cid)return;let e=this.color.toRgb();e.a=t.detail.a,this.color=new E(e),this.render()}hsvChanged(t){!t||!t.detail||!t.detail.cid||t.detail.cid===this.cid&&(this.color=new E({h:t.detail.h,s:t.detail.s,v:t.detail.v,a:this.color.toHsv().a}),this.render())}render(){var t,e,n,i,o;let r=this.color.toRgb();this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.hex=this.color.toHex(),this.$hex&&(null==(t=this.shadowRoot)?void 0:t.activeElement)!==this.$hex&&(this.$hex.value=this.hex.toUpperCase()),this.$r&&(null==(e=this.shadowRoot)?void 0:e.activeElement)!==this.$r&&(this.$r.value=this.r.toString()),this.$g&&(null==(n=this.shadowRoot)?void 0:n.activeElement)!==this.$g&&(this.$g.value=this.g.toString()),this.$b&&(null==(i=this.shadowRoot)?void 0:i.activeElement)!==this.$b&&(this.$b.value=this.b.toString()),this.$a&&(null==(o=this.shadowRoot)?void 0:o.activeElement)!==this.$a&&(this.$a.value=Math.round(100*this.a).toString())}onFieldKeyDown(t,e){var n,i;let o=this.color.toRgb();switch(t.key){case"ArrowUp":if("r"===e){this.r=Math.min(255,o.r+1),o.r=this.r;let t=new E(o).toHsv();a(this.cid,t.h,t.s,t.v),this.$r.value=this.r.toString(),this.render()}if("g"===e){this.g=Math.min(255,o.g+1),o.g=this.g;let t=new E(o).toHsv();a(this.cid,t.h,t.s,t.v),this.$g.value=this.g.toString(),this.render()}if("b"===e){this.b=Math.min(255,o.b+1),o.b=this.b;let t=new E(o).toHsv();a(this.cid,t.h,t.s,t.v),this.$b.value=this.b.toString(),this.render()}if("a"===e){this.a=Math.max(0,Math.min(this.a+.01,1)),this.$a.value=Math.round(100*this.a).toString();let t=this.color.toRgb();t.a=this.a,this.color=new E(t),this.render(),s(this.cid,this.a)}break;case"ArrowDown":if("r"===e){this.r=Math.max(0,o.r-1),o.r=this.r;let t=new E(o).toHsv();a(this.cid,t.h,t.s,t.v),this.$r.value=this.r.toString(),this.render()}if("g"===e){this.g=Math.max(0,o.g-1),o.g=this.g;let t=new E(o).toHsv();a(this.cid,t.h,t.s,t.v),this.$g.value=this.g.toString(),this.render()}if("b"===e){this.b=Math.max(0,o.b-1),o.b=this.b;let t=new E(o).toHsv();a(this.cid,t.h,t.s,t.v),this.$b.value=this.b.toString(),this.render()}if("a"===e){this.a=Math.max(0,this.a-.01),this.$a.value=Math.round(100*this.a).toString();let t=this.color.toRgb();t.a=this.a,this.color=new E(t),this.render(),s(this.cid,this.a)}break;case"Escape":null!=(n=this.shadowRoot)&&n.activeElement&&this.shadowRoot.activeElement.blur(),this.render();break;case"Enter":null!=(i=this.shadowRoot)&&i.activeElement&&this.shadowRoot.activeElement.blur(),this.render()}}onRedKeyDown(t){this.onFieldKeyDown(t,"r")}onGreenKeyDown(t){this.onFieldKeyDown(t,"g")}onBlueKeyDown(t){this.onFieldKeyDown(t,"b")}onAlphaKeyDown(t){this.onFieldKeyDown(t,"a")}onHexChange(t){let e=t.target;if(6!==e.value.length)return;let n=new E(`#${e.value}`);if(n.isValid){this.color=n;let t=this.color.toHsv();a(this.cid,t.h,t.s,t.v)}}onRedChange(t){let e=t.target,n=q(e.value);if(n.toString()===e.value){let t=this.color.toRgb();t.r=n;let e=new E(t).toHsv();a(this.cid,e.h,e.s,e.v)}}onGreenChange(t){let e=t.target,n=q(e.value);if(n.toString()===e.value){let t=this.color.toRgb();t.g=n;let e=new E(t).toHsv();a(this.cid,e.h,e.s,e.v)}}onBlueChange(t){let e=t.target,n=q(e.value);if(n.toString()===e.value){let t=this.color.toRgb();t.b=n;let e=new E(t).toHsv();a(this.cid,e.h,e.s,e.v)}}onAlphaChange(t){let e=t.target,n=(t=>{let e=Number(t)||100;return e=Math.round(e),e=Math.max(0,e),e=Math.min(100,e),e})(e.value);n.toString()===e.value&&s(this.cid,n/100)}connectedCallback(){if(!this.shadowRoot)return;this.cid=this.getAttribute("cid")||"",this.color=K(this.getAttribute("color"));let t=this.color.toRgb();this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.hex=this.color.toHex();let e=A(),r=A(),s=A(),a=A(),h=A();this.shadowRoot.innerHTML=`\n           <style>:root{--tool-cool-color-picker-field-border-color:#cecece;--tool-cool-color-picker-field-label-color:#000}.fields{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Noto Sans,Liberation Sans,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-size:11px;grid-template-columns:60px 35px 35px 35px 34px;text-align:center;display:grid;gap:.25rem;margin-top:.25rem;color:var(--tool-cool-color-picker-field-label-color,#000)}.fields input{background:#fff;border-width:1px;border-style:solid;border-color:var(--tool-cool-color-picker-field-border-color,#cecece);padding:1px 3px;border-radius:2px;color:#000;font-family:inherit;font-size:100%;line-height:inherit;margin:0;box-sizing:border-box}</style>\n           <div class="fields">\n               <input id="hex-${e}" type="text" value="${this.hex.toUpperCase()}" data-type="hex" />\n               <input id="r-${r}" type="text" value="${this.r}" data-type="r" />\n               <input id="g-${s}" type="text" value="${this.g}" data-type="g" />\n               <input id="b-${a}" type="text" value="${this.b}" data-type="b" />\n               <input id="a-${h}" type="text" value="${Math.round(100*this.a)}" data-type="a" />\n               \n               <label for="hex-${e}">Hex</label>\n               <label for="r-${r}">R</label>\n               <label for="g-${s}">G</label>\n               <label for="b-${a}">B</label>\n               <label for="a-${h}">A</label>\n           </div>\n        `,this.$hex=this.shadowRoot.getElementById(`hex-${e}`),this.$r=this.shadowRoot.getElementById(`r-${r}`),this.$g=this.shadowRoot.getElementById(`g-${s}`),this.$b=this.shadowRoot.getElementById(`b-${a}`),this.$a=this.shadowRoot.getElementById(`a-${h}`),document.addEventListener(n,this.hsvChanged),document.addEventListener(i,this.hueChanged),document.addEventListener(o,this.alphaChanged),this.$hex.addEventListener("input",this.onHexChange),this.$r.addEventListener("input",this.onRedChange),this.$g.addEventListener("input",this.onGreenChange),this.$b.addEventListener("input",this.onBlueChange),this.$a.addEventListener("input",this.onAlphaChange),this.$hex.addEventListener("blur",this.render),this.$r.addEventListener("blur",this.render),this.$g.addEventListener("blur",this.render),this.$b.addEventListener("blur",this.render),this.$a.addEventListener("blur",this.render),this.$r.addEventListener("keydown",this.onRedKeyDown),this.$g.addEventListener("keydown",this.onGreenKeyDown),this.$b.addEventListener("keydown",this.onBlueKeyDown),this.$a.addEventListener("keydown",this.onAlphaKeyDown)}disconnectedCallback(){document.removeEventListener(n,this.hsvChanged),document.removeEventListener(i,this.hueChanged),document.removeEventListener(o,this.alphaChanged),this.$hex.removeEventListener("input",this.onHexChange),this.$r.removeEventListener("input",this.onRedChange),this.$g.removeEventListener("input",this.onGreenChange),this.$b.removeEventListener("input",this.onBlueChange),this.$a.removeEventListener("input",this.onAlphaChange),this.$hex.removeEventListener("blur",this.render),this.$r.removeEventListener("blur",this.render),this.$g.removeEventListener("blur",this.render),this.$b.removeEventListener("blur",this.render),this.$a.removeEventListener("blur",this.render),this.$r.removeEventListener("keydown",this.onRedKeyDown),this.$g.removeEventListener("keydown",this.onGreenKeyDown),this.$b.removeEventListener("keydown",this.onBlueKeyDown),this.$a.removeEventListener("keydown",this.onAlphaKeyDown)}attributeChangedCallback(t,e,n){this.color=K(n),this.render()}},T=class extends HTMLElement{constructor(){super(),e(this,"cid"),e(this,"popupPosition","left"),e(this,"$popup"),e(this,"color","#000"),customElements.get("toolcool-color-picker-saturation")||customElements.define("toolcool-color-picker-saturation",U),customElements.get("toolcool-color-picker-hue")||customElements.define("toolcool-color-picker-hue",I),customElements.get("toolcool-color-picker-alpha")||customElements.define("toolcool-color-picker-alpha",X),customElements.get("toolcool-color-picker-fields")||customElements.define("toolcool-color-picker-fields",O),this.cid=this.getAttribute("cid")||"",this.prevent=this.prevent.bind(this),this.attachShadow({mode:"open"})}static get observedAttributes(){return["color","popup-position"]}prevent(t){t.stopPropagation()}connectedCallback(){var t,e;!this.shadowRoot||(this.color=this.getAttribute("color")||"#000",this.popupPosition=this.getAttribute("popup-position")||"left",this.shadowRoot.innerHTML=`\n           <style>:root{--tool-cool-color-picker-popup-bg:#fff;--tool-cool-color-picker-popup-border-color:#cecece;--tool-cool-color-picker-popup-width:214px}.popup{position:absolute;left:0;top:calc(100% - 1px);z-index:50;width:var(--tool-cool-color-picker-popup-width,214px);box-shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px -1px rgba(0,0,0,0.1);padding:.5rem;background:var(--tool-cool-color-picker-popup-bg,#fff);border-width:1px;border-style:solid;border-color:var(--tool-cool-color-picker-popup-border-color,#cecece);border-radius:.25rem}.popup.right{right:0;left:auto}</style>\n           <div class="popup">\n                <toolcool-color-picker-saturation color="${this.color}" cid="${this.cid}"></toolcool-color-picker-saturation>\n                <toolcool-color-picker-hue color="${this.color}" cid="${this.cid}"></toolcool-color-picker-hue>\n                <toolcool-color-picker-alpha color="${this.color}" cid="${this.cid}"></toolcool-color-picker-alpha>\n                <toolcool-color-picker-fields color="${this.color}" cid="${this.cid}"></toolcool-color-picker-fields>\n           </div>\n        `,this.$popup=this.shadowRoot.querySelector(".popup"),null==(t=this.$popup)||t.addEventListener("mousedown",this.prevent),null==(e=this.$popup)||e.classList.toggle("right","right"===this.popupPosition))}disconnectedCallback(){var t;null==(t=this.$popup)||t.removeEventListener("mousedown",this.prevent)}attributeChangedCallback(t,e,n){var i,o,r,s;if("popup-position"===t&&(this.popupPosition=n,this.$popup&&this.$popup.classList.toggle("right","right"===this.popupPosition)),"color"===t){this.color=n;let t=null==(i=this.shadowRoot)?void 0:i.querySelector("toolcool-color-picker-saturation"),e=null==(o=this.shadowRoot)?void 0:o.querySelector("toolcool-color-picker-hue"),a=null==(r=this.shadowRoot)?void 0:r.querySelector("toolcool-color-picker-alpha"),h=null==(s=this.shadowRoot)?void 0:s.querySelector("toolcool-color-picker-fields");t&&t.setAttribute("color",this.color),e&&e.setAttribute("color",this.color),a&&a.setAttribute("color",this.color),h&&h.setAttribute("color",this.color)}}},j={sm:"0.875rem",md:"1.2rem",lg:"1.5rem",xl:"2.25rem","2xl":"3rem","3xl":"3.75rem","4xl":"4.5rem"},F=class extends HTMLElement{constructor(){super(),e(this,"cid"),e(this,"$button"),e(this,"$buttonColor"),e(this,"$popupBox"),e(this,"stateDefaults",{isPopupVisible:!1,popupPosition:"left",initialColor:new E("#000"),color:new E("#000"),buttonWidth:null,buttonHeight:null,buttonPadding:null}),e(this,"state"),this.cid=A(),customElements.get("toolcool-color-picker-popup")||customElements.define("toolcool-color-picker-popup",T),this.attachShadow({mode:"open"}),this.toggle=this.toggle.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.clickedOutside=this.clickedOutside.bind(this),this.stopPropagation=this.stopPropagation.bind(this),this.hsvChanged=this.hsvChanged.bind(this),this.hueChanged=this.hueChanged.bind(this),this.alphaChanged=this.alphaChanged.bind(this),this.buttonClicked=this.buttonClicked.bind(this),this.formatButtonSize=this.formatButtonSize.bind(this),this.initState()}static get observedAttributes(){return["color","popup-position","button-width","button-height","button-padding"]}set color(t){this.state.color=new E(t)}get color(){return this.state.color}get hex(){return this.state.color.toHexString().toUpperCase()}get hex8(){return this.state.color.toHex8String().toUpperCase()}get rgb(){return this.state.color.toRgbString()}get rgba(){return P(this.state.color)}get hsl(){return this.state.color.toHslString()}get hsla(){return(t=>{let e=this.state.color.toHsl();return`hsla(${Math.round(e.h)}, ${Math.round(100*e.s)}%, ${Math.round(100*e.l)}%, ${M(e.a)})`})()}get hsv(){return this.state.color.toHsvString()}get hsva(){return(t=>{let e=this.state.color.toHsv();return`hsva(${Math.round(e.h)}, ${Math.round(100*e.s)}%, ${Math.round(100*e.v)}%, ${M(e.a)})`})()}get opened(){return this.state.isPopupVisible}set opened(t){this.state.isPopupVisible=t}initState(){let t=this;this.state=new Proxy(t.stateDefaults,{set:(e,n,i,o)=>(e[n]=i,"isPopupVisible"===n&&t.onPopupVisibilityChange(),"popupPosition"===n&&t.onPopupPosChange(),"initialColor"===n&&t.onInitialColorChange(),"color"===n&&t.onColorChange(),("buttonWidth"===n||"buttonHeight"===n||"buttonPadding"===n)&&t.setButtonSize(),!0)})}onPopupVisibilityChange(){!this.$popupBox||(this.$popupBox.innerHTML=this.state.isPopupVisible?`<toolcool-color-picker-popup color="${this.state.color.toRgbString()}" cid="${this.cid}" popup-position="${this.state.popupPosition}" />`:"")}onPopupPosChange(){if(!this.$popupBox)return;let t=this.$popupBox.querySelector("toolcool-color-picker-popup");!t||t.setAttribute("popup-position",this.state.popupPosition)}onInitialColorChange(){var t;let e=P(this.state.color);this.$buttonColor&&(this.$buttonColor.style.backgroundColor=e);let n=null==(t=this.shadowRoot)?void 0:t.querySelector("toolcool-color-picker-popup");n&&n.setAttribute("color",e)}setButtonSize(){!this.$button||(this.state.buttonWidth&&(this.$button.style.width=this.formatButtonSize(this.state.buttonWidth)),this.state.buttonHeight&&(this.$button.style.height=this.formatButtonSize(this.state.buttonHeight)),this.state.buttonPadding&&(this.$button.style.padding=this.state.buttonPadding))}onColorChange(){this.$buttonColor&&(this.$buttonColor.style.backgroundColor=P(this.state.color)),this.dispatchEvent(new CustomEvent("change",{detail:{hex:this.hex,hex8:this.hex8,rgb:this.rgb,rgba:this.rgba,hsl:this.hsl,hsla:this.hsla,hsv:this.hsv,hsva:this.hsva,color:this.color}}))}hsvChanged(t){!t||!t.detail||!t.detail.cid||t.detail.cid===this.cid&&(this.state.color=new E({h:t.detail.h,s:t.detail.s,v:t.detail.v,a:this.state.color.toHsv().a}))}hueChanged(t){if(!t||!t.detail||!t.detail.cid||t.detail.cid!==this.cid)return;let e=this.state.color.toHsv();this.state.color=new E({h:t.detail.h,s:e.s,v:e.v,a:e.a})}alphaChanged(t){if(!t||!t.detail||!t.detail.cid||t.detail.cid!==this.cid)return;let e=this.state.color.toRgb();e.a=t.detail.a,this.state.color=new E(e)}buttonClicked(t){!t||!t.detail||!t.detail.cid||t.detail.cid!==this.cid&&(this.state.isPopupVisible=!1)}clickedOutside(){this.state.isPopupVisible=!1}toggle(){let t=this.state.isPopupVisible;window.setTimeout((()=>{var e;this.state.isPopupVisible=!t,!(e=this.cid)||document.dispatchEvent(new CustomEvent(r,{detail:{cid:e}}))}),0)}onKeyDown(t){"Escape"===t.key&&(this.state.isPopupVisible=!1)}stopPropagation(t){t.stopPropagation()}formatButtonSize(t){var e;return null!=(e=j[t])?e:t}connectedCallback(){var t,e,s;!this.shadowRoot||(this.state.initialColor=K(this.getAttribute("color")),this.state.color=K(this.getAttribute("color")),this.state.popupPosition=this.getAttribute("popup-position")||"left",this.state.buttonWidth=this.getAttribute("button-width"),this.state.buttonHeight=this.getAttribute("button-height"),this.state.buttonPadding=this.getAttribute("button-padding"),this.shadowRoot.innerHTML=`\n            <style>\n                :root{--tool-cool-color-picker-btn-bg:#fff;--tool-cool-color-picker-btn-border-color:#cecece;--tool-cool-color-picker-btn-border-color-inner:#626262;--tool-cool-color-picker-btn-border-radius:.25rem;--tool-cool-color-picker-btn-border-radius-inner:0}.color-picker{position:relative}.button{width:3rem;height:1.5rem;padding:.25rem;background:var(--tool-cool-color-picker-btn-bg,#fff);border-radius:var(--tool-cool-color-picker-btn-border-radius,0.25rem);border-width:1px;border-style:solid;border-color:var(--tool-cool-color-picker-btn-border-color,#cecece);cursor:pointer;box-sizing:border-box}.button-color{display:block;width:100%;height:100%;border-width:1px;border-style:solid;border-color:var(--tool-cool-color-picker-btn-border-color-inner,#626262);background:#000;box-sizing:border-box;border-radius:var(--tool-cool-color-picker-btn-border-radius-inner,0)} \n            </style>\n            <div class="color-picker" >\n                <button\n                    type="button"\n                    tabIndex="0"\n                    class="button"\n                    title="Select Color">\n                    <span class="button-color" style="background: ${P(this.state.color)};"></span>\n                </button>\n                <div data-popup-box></div>\n            </div>\n        `,this.$button=this.shadowRoot.querySelector(".button"),this.$buttonColor=this.shadowRoot.querySelector(".button-color"),null==(t=this.$button)||t.addEventListener("click",this.toggle),null==(e=this.$button)||e.addEventListener("keydown",this.onKeyDown),null==(s=this.$button)||s.addEventListener("mousedown",this.stopPropagation),this.$popupBox=this.shadowRoot.querySelector("[data-popup-box]"),this.setButtonSize(),document.addEventListener("mousedown",this.clickedOutside),document.addEventListener(n,this.hsvChanged),document.addEventListener(i,this.hueChanged),document.addEventListener(o,this.alphaChanged),document.addEventListener(r,this.buttonClicked))}disconnectedCallback(){var t,e,s;null==(t=this.$button)||t.removeEventListener("click",this.toggle),null==(e=this.$button)||e.removeEventListener("keydown",this.onKeyDown),null==(s=this.$button)||s.removeEventListener("mousedown",this.stopPropagation),document.removeEventListener("mousedown",this.clickedOutside),document.removeEventListener(n,this.hsvChanged),document.removeEventListener(i,this.hueChanged),document.removeEventListener(o,this.alphaChanged),document.removeEventListener(r,this.buttonClicked)}attributeChangedCallback(t){switch(t){case"color":this.state.initialColor=K(this.getAttribute("color")),this.state.color=K(this.getAttribute("color")),this.onInitialColorChange();break;case"popup-position":this.state.popupPosition=this.getAttribute("popup-position")||"left",this.onPopupPosChange();break;case"button-width":this.state.buttonWidth=this.getAttribute("button-width"),this.setButtonSize();break;case"button-height":this.state.buttonHeight=this.getAttribute("button-height"),this.setButtonSize();break;case"button-padding":this.state.buttonPadding=this.getAttribute("button-padding"),this.setButtonSize()}}};customElements.get("toolcool-color-picker")||customElements.define("toolcool-color-picker",F)})();class Ln{constructor(t,e){n(this,"linePath",[]),n(this,"color","rgb(255, 0, 0)"),n(this,"isClose",!1),this.color=e.color||"rgb(255, 0, 0)",this.drawArea=t,this.polylineSvg=this.drawArea.svgSelector.append("polyline"),this.polylineSvg.attr("fill","transparent")}renderByPath(t){this.linePath=t,this.polylineSvg.attr("fill",this.color),this.draw(),this.isClose=!0}onPointMove(t,e){this.isClose||(this.linePath.length>1&&this.linePath.pop(),this.linePath.push([t,e]),this.draw())}updateColor(t){this.color=t,this.draw(),this.isClose&&this.polylineSvg.attr("fill",this.color)}onSave(){}onPointDown(t,e,n){if(!this.isClose){if(2===n){if(this.linePath.length<=1)return;this.isClose=!0,this.linePath.push(this.linePath[0]),this.polylineSvg.attr("fill",this.color),this.onSave()}else this.linePath.push([t,e]);this.draw()}}draw(){var t;const e=this.linePath.map((t=>t.join(","))).join(" ");null===(t=this.polylineSvg)||void 0===t||t.attr("points",e).attr("stroke",this.color).attr("stroke-width",2).attr("stroke-linecap","round").attr("stroke-linejoin","round")}}var Rn={DrawArea:class{constructor(t,e){n(this,"util",null),n(this,"eventListeners",new Set),n(this,"scale",1),n(this,"transformX",0),n(this,"transformY",0),n(this,"isPointDown",!1),n(this,"lastX",0),n(this,"lastY",0),n(this,"viewBoxWidth",0),n(this,"viewBoxHeight",0),this.svgSelector=function(t){return"string"==typeof t?new gt([[document.querySelector(t)]],[document.documentElement]):new gt([[t]],ft)}(e),this.controlSelector=document.querySelector(t),this.initEventListener()}initEventListener(){this.controlSelector.addEventListener("mousedown",this.onMouseDown.bind(this)),this.controlSelector.addEventListener("contextmenu",(t=>{t.preventDefault()})),this.controlSelector.addEventListener("mousemove",this.onMouseMove.bind(this))}onMouseDown(t){if(console.log(t),[1,2].includes(t.buttons)){this.isPointDown=!0,t.preventDefault();const e=t.offsetX,n=t.offsetY;this.dispatchEvent("pointDown",{x:e,y:n,button:t.buttons})}}onMouseMove(t){const e=t.offsetX,n=t.offsetY;this.isPointDown&&this.dispatchEvent("pointMove",{x:e,y:n,button:1})}clear(){this.svgSelector.selectChildren("*").remove()}addEventListener(t){return this.eventListeners.add(t),()=>{this.eventListeners.delete(t)}}dispatchEvent(t,e){this.eventListeners.forEach((n=>n({type:t,data:e})))}toCanvas(){const t=this.svgSelector.node(),{width:e,height:n}=t.getBoundingClientRect(),i=new XMLSerializer,o=t.cloneNode(!0),r=i.serializeToString(o),s=new Image,a=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),h=URL.createObjectURL(a);return new Promise((t=>{const i=document.createElement("canvas"),o=i.getContext("2d");i.width=e,i.height=n,o.fillStyle="#ffffff",o.strokeStyle="#ffffff",null==o||o.fillRect(0,0,e,n),s.addEventListener("load",(()=>{o&&o.drawImage(s,0,0,e,n),URL.revokeObjectURL(h),t(i)}),{once:!0}),s.src=h}))}toBase64(){return this.toCanvas().then((t=>t.toDataURL("image/jpeg")))}},PolylineManager:class{constructor(t){n(this,"polylines",[]),n(this,"color","rgb(255, 0, 0)"),this.drawArea=t}onPointMove(t,e){if(this.polylines.length>0){const n=this.polylines[this.polylines.length-1];n.isClose||n.onPointMove(t,e)}}updateAllColor(t){this.color=t,this.polylines.forEach((e=>e.updateColor(t)))}clear(){this.polylines=[],this.onSave()}getAllClosedPolylineInfo(){return this.polylines.filter((t=>t.isClose)).map((t=>({path:t.linePath,color:t.color})))}drawPolylines(t){this.polylines=t.map((t=>{const e=new Ln(this.drawArea,{color:this.color});return e.renderByPath(t.path),e}))}onSave(){}onPointDown(t,e,n){let i=null;0===this.polylines.length?(i=new Ln(this.drawArea,{color:this.color}),i.onSave=()=>{this.onSave()},this.polylines.push(i)):i=this.polylines[this.polylines.length-1],i.isClose&&(i=new Ln(this.drawArea,{color:this.color}),i.onSave=()=>{this.onSave()},this.polylines.push(i)),i.onPointDown(t,e,n)}}};return e.default}()}));